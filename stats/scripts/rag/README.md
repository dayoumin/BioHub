# RAG Build Scripts

RAG ë°ì´í„°ë² ì´ìŠ¤ ë¹Œë“œ ë° ê´€ë¦¬ë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ëª¨ìŒì…ë‹ˆë‹¤.

## ğŸ“ ìŠ¤í¬ë¦½íŠ¸ ëª©ë¡

| ìŠ¤í¬ë¦½íŠ¸ | ì—­í•  | ì‹¤í–‰ ì‹œì  |
|---------|------|----------|
| `copy-db.js` | rag.dbë¥¼ public ë””ë ‰í† ë¦¬ë¡œ ë³µì‚¬ | prebuild (ìë™) |
| `generate-metadata.js` | vector-stores.json ë©”íƒ€ë°ì´í„° ìƒì„± | prebuild (ìë™) |
| `verify-stores.js` | Vector Store ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦ | ìˆ˜ë™ |
| `semantic-rechunk.ts` | ì‹œë§¨í‹± ê¸°ë°˜ ë¬¸ì„œ ì¬ë¶„í•  | ìˆ˜ë™ |

## ğŸ”„ DB ìƒì„± ì „ì²´ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1ë‹¨ê³„: ë¬¸ì„œ ìˆ˜ì§‘ (ìˆ˜ë™ ì‹¤í–‰)                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ $ cd rag-system/scripts                                          â”‚
â”‚ $ python crawl_scipy_batch.py                                    â”‚
â”‚ $ python crawl_statsmodels_batch.py                              â”‚
â”‚ $ python crawl_numpy_batch.py                                    â”‚
â”‚ $ python crawl_openintro_batch.py                                â”‚
â”‚ $ python crawl_pingouin_batch.py                                 â”‚
â”‚ â†’ ì¶œë ¥: rag-system/data/{scipy,statsmodels,...}/*.md             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2ë‹¨ê³„: SQLite DB êµ¬ì¶• (ìˆ˜ë™ ì‹¤í–‰)                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ $ cd rag-system/scripts                                          â”‚
â”‚ $ python build_sqlite_db.py                                      â”‚
â”‚ â†’ ì¶œë ¥: rag-system/data/rag.db (111ê°œ ë¬¸ì„œ)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3ë‹¨ê³„: ì„ë² ë”© ìƒì„± (ìˆ˜ë™ ì‹¤í–‰)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ $ cd rag-system/scripts                                          â”‚
â”‚ $ python generate_embeddings.py                                  â”‚
â”‚ â†’ ì¶œë ¥: rag-system/data/vector-qwen3-embedding-0.6b.db           â”‚
â”‚         rag-system/data/vector-mxbai-embed-large.db              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4ë‹¨ê³„: ë¹Œë“œ ì‹œ ìë™ ì‹¤í–‰ (npm run build)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ prebuild í›…:                                                     â”‚
â”‚   1. copy-db.js: rag-system/data/*.db â†’ public/rag-data/         â”‚
â”‚   2. generate-metadata.js: vector-stores.json ìƒì„±               â”‚
â”‚ â†’ ì¶œë ¥: public/rag-data/vector-stores.json                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ íŒŒì¼ ìœ„ì¹˜

### ì†ŒìŠ¤ (Git ë¯¸ì¶”ì )
```
rag-system/data/
â”œâ”€â”€ rag.db                           # ì›ë³¸ SQLite DB (111ê°œ ë¬¸ì„œ)
â”œâ”€â”€ vector-qwen3-embedding-0.6b.db   # Qwen3 ì„ë² ë”© ë²¡í„° ìŠ¤í† ì–´
â”œâ”€â”€ vector-mxbai-embed-large.db      # MixedBread AI ë²¡í„° ìŠ¤í† ì–´
â”œâ”€â”€ scipy/                           # í¬ë¡¤ë§ëœ SciPy ë¬¸ì„œ
â”œâ”€â”€ statsmodels/                     # í¬ë¡¤ë§ëœ statsmodels ë¬¸ì„œ
â”œâ”€â”€ numpy/                           # í¬ë¡¤ë§ëœ NumPy ë¬¸ì„œ
â”œâ”€â”€ openintro/                       # OpenIntro í†µê³„ êµì¬
â””â”€â”€ pingouin/                        # Pingouin ë¬¸ì„œ
```

### ë¹Œë“œ ì¶œë ¥ (Git ë¯¸ì¶”ì )
```
public/rag-data/
â”œâ”€â”€ rag.db                           # ë³µì‚¬ëœ DB
â”œâ”€â”€ vector-qwen3-embedding-0.6b.db   # ë³µì‚¬ëœ ë²¡í„° ìŠ¤í† ì–´
â”œâ”€â”€ vector-mxbai-embed-large.db      # ë³µì‚¬ëœ ë²¡í„° ìŠ¤í† ì–´
â””â”€â”€ vector-stores.json               # ë©”íƒ€ë°ì´í„° (ìë™ ìƒì„±)
```

## ğŸ› ï¸ ìŠ¤í¬ë¦½íŠ¸ ìƒì„¸

### copy-db.js

**ì—­í• **: `rag-system/data/*.db` â†’ `public/rag-data/` ë³µì‚¬

**ì‹¤í–‰**: prebuild í›…ì—ì„œ ìë™ ì‹¤í–‰

**ë™ì‘**:
1. `public/rag-data/` ë””ë ‰í† ë¦¬ ìƒì„± (ì—†ìœ¼ë©´)
2. `rag.db` íŒŒì¼ ì¡´ì¬ í™•ì¸
3. ì¡´ì¬í•˜ë©´ ë³µì‚¬, ì—†ìœ¼ë©´ ê²½ê³ ë§Œ í‘œì‹œ (ë¹Œë“œëŠ” ê³„ì†)

**ê²½ê³  ë©”ì‹œì§€**:
```
âš ï¸ Warning: rag.db not found at [path]
   Build DB first: cd rag-system && python scripts/build_sqlite_db.py
```
â†’ ì´ ê²½ê³ ëŠ” RAG ê¸°ëŠ¥ ë¯¸ì‚¬ìš© ì‹œ ë¬´ì‹œí•´ë„ ë©ë‹ˆë‹¤.

---

### generate-metadata.js

**ì—­í• **: Vector Store ë©”íƒ€ë°ì´í„° JSON ìƒì„±

**ì‹¤í–‰**: prebuild í›…ì—ì„œ ìë™ ì‹¤í–‰

**ë™ì‘**:
1. `public/rag-data/` ë””ë ‰í† ë¦¬ ìŠ¤ìº”
2. `vector-*.db` íŒŒì¼ ê²€ìƒ‰
3. ê° DBì—ì„œ ë©”íƒ€ë°ì´í„° ì¶”ì¶œ:
   - ë¬¸ì„œ ìˆ˜ (`SELECT COUNT(*) FROM documents`)
   - ì„ë² ë”© ì°¨ì› (BLOB í¬ê¸° ë¶„ì„)
   - íŒŒì¼ í¬ê¸°, ìˆ˜ì •ì¼
4. `vector-stores.json` ìƒì„±

**ì¶œë ¥ ì˜ˆì‹œ**:
```json
[
  {
    "id": "qwen3-embedding-0.6b",
    "name": "Qwen3 Embedding (0.6B)",
    "dbPath": "/rag-data/vector-qwen3-embedding-0.6b.db",
    "embeddingModel": "qwen3-embedding:0.6b",
    "dimensions": 1024,
    "docCount": 111,
    "fileSize": "5.4 MB",
    "createdAt": 1762128783193
  }
]
```

---

### verify-stores.js

**ì—­í• **: Vector Store ë°ì´í„° ë¬´ê²°ì„± ê²€ì¦

**ì‹¤í–‰**: ìˆ˜ë™ (`npm run verify:rag`)

**ê²€ì¦ í•­ëª©**:
- DB íŒŒì¼ ì¡´ì¬ ì—¬ë¶€
- ë¬¸ì„œ ìˆ˜ í™•ì¸ (ì˜ˆìƒ: 111ê°œ)
- ì„ë² ë”© ì¡´ì¬ ì—¬ë¶€
- íŒŒì¼ëª…-DB ëª¨ë¸ëª… ì¼ì¹˜ì„±
- ì„ë² ë”© ì°¨ì› í™•ì¸ (ì˜ˆìƒ: 1024)

---

### semantic-rechunk.ts

**ì—­í• **: ì‹œë§¨í‹± ê¸°ë°˜ ë¬¸ì„œ ì¬ë¶„í• 

**ì‹¤í–‰**: ìˆ˜ë™ (`npm run rag:semantic-rechunk`)

**ìƒì„¸**: [README-SEMANTIC-CHUNKING.md](README-SEMANTIC-CHUNKING.md)

## ğŸ“‹ npm scripts

```bash
# ë¹Œë“œ (prebuild ìë™ ì‹¤í–‰)
npm run build

# ë©”íƒ€ë°ì´í„° ì¬ìƒì„±
npm run generate:vector-stores

# Vector Store ê²€ì¦
npm run verify:rag

# ì‹œë§¨í‹± ì¬ì²­í‚¹
npm run rag:semantic-rechunk
```

## âš ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### "rag.db not found" ê²½ê³ 

**ì›ì¸**:
- Fresh clone í›„ DB íŒŒì¼ì´ ì—†ìŒ (.gitignoreë¡œ ì œì™¸ë¨)
- ë˜ëŠ” RAG ì‹œìŠ¤í…œ ë¯¸ì„¤ì • ìƒíƒœ

**í•´ê²°ì±…**:
```bash
# ë°©ë²• 1: DB ì§ì ‘ ìƒì„±
cd rag-system/scripts
python crawl_scipy_batch.py
python crawl_statsmodels_batch.py
python build_sqlite_db.py
python generate_embeddings.py

# ë°©ë²• 2: RAG ê¸°ëŠ¥ ë¯¸ì‚¬ìš© (ê²½ê³  ë¬´ì‹œ)
# ë¹Œë“œëŠ” ì •ìƒ ì§„í–‰ë¨ (exit 0)
```

### "No vector-*.db files found" ê²½ê³ 

**ì›ì¸**: ì„ë² ë”© ìƒì„±ì´ ì•ˆ ë¨

**í•´ê²°ì±…**:
```bash
cd rag-system/scripts
python generate_embeddings.py
```

### vector-stores.jsonì´ ë¹„ì–´ìˆìŒ

**ì›ì¸**: `public/rag-data/`ì— vector-*.db íŒŒì¼ ì—†ìŒ

**í•´ê²°ì±…**:
1. `rag-system/data/`ì— vector-*.db ì¡´ì¬ í™•ì¸
2. `npm run build` ì¬ì‹¤í–‰ (copy-db.jsê°€ ë³µì‚¬)

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

- [rag-system/README.md](../../rag-system/README.md) - RAG ì‹œìŠ¤í…œ ê°œìš”
- [rag-system/ARCHITECTURE.md](../../rag-system/ARCHITECTURE.md) - ì•„í‚¤í…ì²˜ ìƒì„¸
- [README-SEMANTIC-CHUNKING.md](README-SEMANTIC-CHUNKING.md) - ì‹œë§¨í‹± ì²­í‚¹ ì „ëµ
