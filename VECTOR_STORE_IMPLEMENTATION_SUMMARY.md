# ë²¡í„°ìŠ¤í† ì–´ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬í˜„ ê³„íš - ìµœì¢… ìš”ì•½

## ğŸ“Œ í•µì‹¬ ë‚´ìš©

### ì„ íƒëœ ì•„í‚¤í…ì²˜: **í•˜ì´ë¸Œë¦¬ë“œ (í˜ì´ì§€ + ëª¨ë‹¬)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FloatingChatbot (í”Œë¡œíŒ… ì±—ë´‡)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ—„ï¸ VectorStore | âš™ï¸ Settings | â– | âœ•     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  ë²¡í„°ìŠ¤í† ì–´ ë²„íŠ¼ â†’ /chatbot/vector-stores  â”‚
â”‚  (ë³„ë„ í˜ì´ì§€, í’ë¶€í•œ ê¸°ëŠ¥)                â”‚
â”‚                                             â”‚
â”‚  ì„¤ì • ë²„íŠ¼ â†’ ChatbotSettings ëª¨ë‹¬          â”‚
â”‚  (ê¸°ì¡´ ìœ ì§€, ê°€ë³ê³  ë¹ ë¥¸ ì ‘ê·¼)             â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ êµ¬í˜„ ê·œëª¨

| Phase | ë‹´ë‹¹ | ê¸°ê°„ | ìƒíƒœ |
|-------|------|------|------|
| **Phase 1** | ë°±ì—”ë“œ API | 4ì¼ | â³ ëŒ€ê¸° |
| **Phase 2** | í”„ë¡ íŠ¸ì—”ë“œ UI | 5ì¼ | â³ ëŒ€ê¸° |
| **Phase 3** | í…ŒìŠ¤íŠ¸ & QA | 3-4ì¼ | â³ ëŒ€ê¸° |
| **Phase 4** | ë°°í¬ & ëª¨ë‹ˆí„°ë§ | ì§„í–‰í˜• | â³ ëŒ€ê¸° |
| **ì´ ì†Œìš” ì‹œê°„** | | **12-13ì¼ (ì•½ 2ì£¼)** | |

---

## ğŸ“š ìƒì„±ëœ ë¬¸ì„œ

### 1. VECTOR_STORE_MANAGEMENT_PLAN.md â­
**ì™„ì „í•œ ê¸°ìˆ  ì‚¬ì–‘ì„œ**
- âœ… Phase 1-4 ìƒì„¸ ê³„íš
- âœ… API ì—”ë“œí¬ì¸íŠ¸ 20ê°œ ì„¤ê³„
- âœ… ì»´í¬ë„ŒíŠ¸ & í›… ì„¤ê³„ (TypeScript)
- âœ… ë°ì´í„° êµ¬ì¡° (4ê°œ IndexedDB Store)
- âœ… ì„±ëŠ¥ ëª©í‘œ & í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
- âœ… ì½”ë”© í‘œì¤€ ì¤€ìˆ˜ (CLAUDE.md ê¸°ë°˜)

**ìœ„ì¹˜**: `d:\Projects\Statics\VECTOR_STORE_MANAGEMENT_PLAN.md`

### 2. VECTOR_STORE_MANAGEMENT_UI_ANALYSIS.md ğŸ“Š
**UI ìœ„ì¹˜ ì„ íƒ ë¶„ì„**
- âœ… ëª¨ë‹¬ vs í˜ì´ì§€ ë¹„êµ
- âœ… ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •
- âœ… ì‚¬ìš© ì‚¬ë¡€ë³„ ë¶„ì„
- âœ… ìµœì¢… í•˜ì´ë¸Œë¦¬ë“œ ì¶”ì²œ
- âœ… FloatingChatbot ìˆ˜ì • ê³„íš

**ìœ„ì¹˜**: `d:\Projects\Statics\VECTOR_STORE_MANAGEMENT_UI_ANALYSIS.md`

### 3. VECTOR_STORE_IMPLEMENTATION_SUMMARY.md (ì´ ë¬¸ì„œ)
**ë¹ ë¥¸ ì°¸ì¡° ê°€ì´ë“œ**
- í•µì‹¬ ì‚¬í•­ ìš”ì•½
- ì½”ë”© í‘œì¤€ ì²´í¬ë¦¬ìŠ¤íŠ¸
- ë‹¤ìŒ ë‹¨ê³„

---

## ğŸ”§ ì½”ë”© í‘œì¤€ ì¤€ìˆ˜ ì‚¬í•­

### TypeScript íƒ€ì… ì•ˆì „ì„± (CRITICAL)
```typescript
âŒ any íƒ€ì… ê¸ˆì§€
âœ… unknown + íƒ€ì… ê°€ë“œ ì‚¬ìš©

ì˜ˆì‹œ:
function processData(data: unknown): string {
  if (!data || typeof data !== 'object') {
    throw new Error('Invalid data')
  }
  if (!('name' in data) || typeof data.name !== 'string') {
    throw new Error('Invalid name property')
  }
  return data.name
}
```

### ì—ëŸ¬ ì²˜ë¦¬ (CRITICAL)
```typescript
âŒ ì—ëŸ¬ ë¬´ì‹œ ë˜ëŠ” ë¯¸ì²˜ë¦¬
âœ… try-catch + ëª…í™•í•œ ë©”ì‹œì§€

ì˜ˆì‹œ:
export async function POST(request: Request): Promise<Response> {
  try {
    // ... ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    return Response.json(result)
  } catch (error) {
    const message = error instanceof Error ? error.message : 'Unknown error'
    console.error('Operation failed:', message)
    return Response.json({ error: message }, { status: 500 })
  }
}
```

### React Hooks (CRITICAL)
```typescript
âŒ ëª¨ë“  ìƒíƒœë¥¼ useStateë¡œ ê´€ë¦¬, setTimeout ì‚¬ìš©
âœ… useCallbackìœ¼ë¡œ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë˜í•‘, async/await ì‚¬ìš©

ì˜ˆì‹œ:
const handleDelete = useCallback(async (id: string) => {
  if (!id) return  // early return

  setIsLoading(true)
  try {
    await deleteDocument(id)
    await refresh()  // ë°ì´í„° ì¬ë¡œë“œ
  } catch (error) {
    setError(error instanceof Error ? error.message : 'Unknown error')
  } finally {
    setIsLoading(false)
  }
}, [])
```

---

## ğŸ“‹ êµ¬í˜„ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ë… ë¬¸ì„œ
- [ ] `CLAUDE.md` ì „ì²´ ì½ìŒ (AI ì½”ë”© ê·œì¹™)
- [ ] `AI-CODING-RULES.md` ìˆ™ì§€ (any â†’ unknown íŒ¨í„´)
- [ ] `STATISTICS_PAGE_CODING_STANDARDS.md` ì°¸ê³  (hooks íŒ¨í„´)

### ê°œë°œ í™˜ê²½
- [ ] TypeScript strict ëª¨ë“œ í™œì„±í™” (tsconfig.json)
- [ ] ESLint exhaustive-deps ê·œì¹™ ì ìš©
- [ ] prettier í¬ë§·íŒ… ìë™í™”

### í…ŒìŠ¤íŠ¸ í™˜ê²½
- [ ] Jest ì„¤ì • í™•ì¸
- [ ] React Testing Library ì„¤ì¹˜
- [ ] Playwright ë˜ëŠ” Cypress ì„¤ì •

### ë°ì´í„° ê´€ë¦¬
- [ ] ê¸°ì¡´ ë²¡í„°ìŠ¤í† ì–´ ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ ìˆ˜ë¦½
- [ ] IndexedDB ë°±ì—… ê³„íš
- [ ] ë¡¤ë°± ê³„íš ìˆ˜ë¦½

---

## ğŸš€ ë‹¤ìŒ ë‹¨ê³„

### Step 1: ê³„íš ê²€í† 
```
1. ì´ ë¬¸ì„œ 3ê°œ ê²€í† 
2. í”¼ë“œë°± ìˆ˜ì§‘
3. ê³„íš ìµœì¢… í™•ì •
```

### Step 2: Phase 1 ì‹œì‘ (ë°±ì—”ë“œ API)
```
1. íƒ€ì…/ì¸í„°í˜ì´ìŠ¤ ì •ì˜ (lib/types)
2. ì„œë¹„ìŠ¤ ê³„ì¸µ êµ¬í˜„ (lib/services)
   - VectorStoreManager
   - DocumentManager
   - OllamaModelManager
   - IndexingJobManager
3. API Routes êµ¬í˜„ (app/api/rag)
4. Python Workers ì‘ì„± (public/workers/python)
5. API í…ŒìŠ¤íŠ¸
```

### Step 3: Phase 2 ì‹œì‘ (í”„ë¡ íŠ¸ì—”ë“œ UI)
```
1. ì»¤ìŠ¤í…€ Hooks êµ¬í˜„
2. /chatbot/vector-stores í˜ì´ì§€
3. /chatbot/vector-stores/:id ìƒì„¸ í˜ì´ì§€
4. ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (ì¹´ë“œ, ë¦¬ìŠ¤íŠ¸, ëª¨ë‹¬ ë“±)
5. FloatingChatbot ìˆ˜ì • (ë²¡í„°ìŠ¤í† ì–´ ë²„íŠ¼ ì¶”ê°€)
```

### Step 4: Phase 3 & 4 (í…ŒìŠ¤íŠ¸ & ë°°í¬)
```
1. í†µí•© í…ŒìŠ¤íŠ¸ ì‹¤í–‰
2. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬
3. ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸
4. ëª¨ë‹ˆí„°ë§ ì„¤ì •
```

---

## ğŸ’¾ íŒŒì¼ êµ¬ì¡° (ìµœì¢…)

```
lib/
â”œâ”€â”€ services/vector-store/
â”‚   â”œâ”€â”€ vector-store-manager.ts
â”‚   â”œâ”€â”€ document-manager.ts
â”‚   â”œâ”€â”€ ollama-model-manager.ts
â”‚   â””â”€â”€ indexing-job-manager.ts
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ use-vector-stores.ts
â”‚   â”œâ”€â”€ use-documents.ts
â”‚   â”œâ”€â”€ use-indexing-job.ts
â”‚   â””â”€â”€ use-embedding-models.ts
â””â”€â”€ types/
    â””â”€â”€ vector-store.ts

components/rag/
â”œâ”€â”€ vector-store-card.tsx
â”œâ”€â”€ document-list.tsx
â”œâ”€â”€ add-document-modal.tsx
â”œâ”€â”€ indexing-progress-bar.tsx
â””â”€â”€ embedding-model-card.tsx

app/api/rag/
â”œâ”€â”€ vector-stores/
â”œâ”€â”€ documents/
â”œâ”€â”€ ollama/
â””â”€â”€ indexing-jobs/

app/chatbot/
â”œâ”€â”€ vector-stores/
â”‚   â”œâ”€â”€ page.tsx
â”‚   â””â”€â”€ [id]/page.tsx
â””â”€â”€ embedding-models/
    â””â”€â”€ page.tsx
```

---

## ğŸ“Š ì„±ëŠ¥ ëª©í‘œ

| ì§€í‘œ | ëª©í‘œ | ì¸¡ì • ë‹¨ìœ„ |
|------|------|----------|
| ë²¡í„°ìŠ¤í† ì–´ ìƒì„± ì‹œê°„ | < 1ë¶„ | ì´ˆ |
| 100ê°œ ë¬¸ì„œ ì„ë² ë”© | < 30ì´ˆ | ì´ˆ |
| ë²¡í„° ê²€ìƒ‰ (top-5) | < 500ms | ms |
| í˜ì´ì§€ ë¡œë“œ ì‹œê°„ | < 2ì´ˆ | ì´ˆ |
| ë©”ëª¨ë¦¬ (1000ê°œ ë¬¸ì„œ) | < 500MB | MB |

---

## âš ï¸ ì£¼ìš” ì£¼ì˜ì‚¬í•­

### Phase 1 êµ¬í˜„ ì‹œ
- SQLite ìš©ëŸ‰ ì œí•œ (ìµœëŒ€ 100MB)
- Ollama ì—°ê²° ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ ë¡œì§
- ëª¨ë¸ë³„ ì„ë² ë”© ì°¨ì› ê²€ì¦ (1024 vs 768 vs 512)

### Phase 2 êµ¬í˜„ ì‹œ
- ì—¬ëŸ¬ íƒ­ ë™ì‹œ ìˆ˜ì • ì‹œ conflict í•´ê²°
- ëª¨ë°”ì¼ ë°˜ì‘í˜• (í…Œì´ë¸” â†’ ì¹´ë“œ)
- ë‹¤í¬ ëª¨ë“œ í…ŒìŠ¤íŠ¸

### Phase 3 í…ŒìŠ¤íŠ¸ ì‹œ
- Ollama ì˜¤í”„ë¼ì¸ ì‹œë‚˜ë¦¬ì˜¤
- ëŒ€ìš©ëŸ‰ ì„ë² ë”© ì„±ëŠ¥ (1000ê°œ)
- ë¸Œë¼ìš°ì € í˜¸í™˜ì„± (Chrome, Edge, Firefox, Safari)

---

## ğŸ“ ì½”ë”© ì˜ˆì‹œ

### íƒ€ì… ì•ˆì „í•œ Hook ì‘ì„±
```typescript
interface UseVectorStoresReturn {
  stores: VectorStoreMetadata[]
  isLoading: boolean
  error: Error | null
  createStore: (req: CreateVectorStoreRequest) => Promise<VectorStoreMetadata>
}

export function useVectorStores(): UseVectorStoresReturn {
  const [stores, setStores] = useState<VectorStoreMetadata[]>([])
  const [isLoading, setIsLoading] = useState(false)
  const [error, setError] = useState<Error | null>(null)

  const createStore = useCallback(async (req: CreateVectorStoreRequest) => {
    if (!req?.name || !req?.embeddingModel) {
      throw new Error('Invalid request')
    }

    setIsLoading(true)
    try {
      const response = await fetch('/api/rag/vector-stores', {
        method: 'POST',
        body: JSON.stringify(req),
      })

      if (!response.ok) {
        throw new Error(`API error: ${response.status}`)
      }

      const data = (await response.json()) as { metadata: VectorStoreMetadata }
      setStores((prev) => [...prev, data.metadata])
      return data.metadata
    } catch (err) {
      const error = err instanceof Error ? err : new Error('Unknown error')
      setError(error)
      throw error
    } finally {
      setIsLoading(false)
    }
  }, [])

  return { stores, isLoading, error, createStore }
}
```

### íƒ€ì… ì•ˆì „í•œ API Route
```typescript
import { NextRequest } from 'next/server'

interface CreateVectorStoreBody {
  name: string
  embeddingModel: string
  documents?: Array<{ title: string; content: string }>
}

export async function POST(request: NextRequest): Promise<Response> {
  try {
    const body = (await request.json()) as unknown

    // ìœ íš¨ì„± ê²€ì‚¬
    if (!body || typeof body !== 'object') {
      return Response.json({ error: 'Invalid request body' }, { status: 400 })
    }

    if (!('name' in body) || typeof body.name !== 'string') {
      return Response.json({ error: 'Invalid name' }, { status: 400 })
    }

    if (!('embeddingModel' in body) || typeof body.embeddingModel !== 'string') {
      return Response.json({ error: 'Invalid embeddingModel' }, { status: 400 })
    }

    const typedBody = body as CreateVectorStoreBody

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    const result = await createVectorStoreService(typedBody)
    return Response.json(result)
  } catch (error) {
    const message = error instanceof Error ? error.message : 'Unknown error'
    console.error('Vector store creation failed:', message)
    return Response.json({ error: message }, { status: 500 })
  }
}
```

---

## ğŸ“ ë¬¸ì˜ ì‚¬í•­

êµ¬í˜„ ì¤‘ ë‹¤ìŒ ì‚¬í•­ì„ í™•ì¸í•˜ì„¸ìš”:

1. **TypeScript ì»´íŒŒì¼**: `npx tsc --noEmit`
2. **ë¦°íŠ¸ ì²´í¬**: `npm run lint`
3. **í…ŒìŠ¤íŠ¸ ì‹¤í–‰**: `npm test`
4. **ë¹Œë“œ ê²€ì¦**: `npm run build`

ëª¨ë“  ëª…ë ¹ì´ ì„±ê³µí•˜ë©´ Phase ì§„í–‰ ì¤€ë¹„ ì™„ë£Œì…ë‹ˆë‹¤.

---

## ğŸ‰ ë§ˆë¬´ë¦¬

ì´ ê³„íšì„œëŠ” ë‹¤ìŒì„ í¬í•¨í•©ë‹ˆë‹¤:

âœ… ì™„ì „í•œ ê¸°ìˆ  ì‚¬ì–‘ì„œ (VECTOR_STORE_MANAGEMENT_PLAN.md)
âœ… UI ìœ„ì¹˜ ì„ íƒ ë¶„ì„ (VECTOR_STORE_MANAGEMENT_UI_ANALYSIS.md)
âœ… ì½”ë”© í‘œì¤€ ì¤€ìˆ˜ ê°€ì´ë“œ (CLAUDE.md ê¸°ë°˜)
âœ… êµ¬í˜„ ë¡œë“œë§µ
âœ… ì„±ëŠ¥ ëª©í‘œ & í…ŒìŠ¤íŠ¸ ê³„íš

**êµ¬í˜„ ì¤€ë¹„ ì™„ë£Œ!** ğŸš€

---

**ì‘ì„±ì**: Claude Code
**ì‘ì„±ì¼**: 2025-11-03
**ìƒíƒœ**: âœ… ìµœì¢… ê²€í†  ì™„ë£Œ
**ë‹¤ìŒ ë‹¨ê³„**: Phase 1 êµ¬í˜„ ì‹œì‘
