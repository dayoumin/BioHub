# 🧪 스트리밍 & 크기 조절 테스트 가이드

**작성일**: 2025-11-02
**대상**: QA, 개발자
**테스트 환경**: Chrome 120+, Firefox 121+, Edge 120+

---

## 📋 테스트 체크리스트

### ✅ 사전 준비

```bash
# 1. 개발 서버 시작
npm run dev
# → http://localhost:3010에서 접속 가능

# 2. Ollama 서버 확인
curl http://localhost:11434/api/tags
# → 모델 목록 표시 (qwen3:4b 등)

# 3. 개발자 도구 열기
F12 → Console 탭 활성화
```

---

## 🎯 Test Suite 1: 플로팅 챗봇 크기 조절

### T1.1: 기본 열기/닫기

**절차**:
1. 우하단 💬 버튼 클릭
2. 팝업 열림 확인
3. ❌ 닫기 버튼 클릭
4. 팝업 닫힘 확인

**예상 결과**: ✅ 팝업이 정상적으로 열리고 닫힘

---

### T1.2: 4방향 크기 조절 (우측 하단 모서리)

**절차**:
```
1. 💬 버튼 클릭 → 팝업 열기
2. 팝업 우측 하단 모서리를 마우스로 드래그
   ↘️ 오른쪽으로 당기기
   ↙️ 왼쪽으로 당기기
   ↑ 위로 당기기
   ↓ 아래로 당기기
```

**예상 결과**:
- ✅ 모든 방향으로 크기 조절 가능
- ✅ `resize: both` CSS 적용됨
- ✅ 최소값 400×400px 이상
- ✅ 최대값 90vw×90vh 이하

**콘솔 확인**:
```javascript
// 개발자 도구에서 팝업 요소 검사
const popup = document.querySelector('.resizable-container')
const styles = getComputedStyle(popup)
console.log('resize:', styles.resize)  // "both"
console.log('overflow:', styles.overflow)  // "auto"
```

---

### T1.3: 최소/최대 크기 제약

**절차**:
1. 팝업 우측 하단을 최대한 왼쪽으로 드래그
2. 팝업이 400px 미만으로 축소되지 않는지 확인

**예상 결과**:
- ✅ 최소 폭/높이: 400px
- ✅ 최대 폭/높이: 90% 뷰포트
- ✅ 제약이 부드럽게 적용됨

---

### T1.4: 최소화 기능

**절차**:
1. 팝업 헤더의 ➖ 버튼 클릭
2. 팝업이 최소화됨
3. ➖ 버튼을 다시 클릭
4. 팝업이 복원됨

**예상 결과**:
- ✅ 최소화: 헤더만 표시, 채팅 영역 숨김
- ✅ 복원: 채팅 영역 다시 표시
- ✅ 크기 유지: 이전 크기 기억

---

## 🎯 Test Suite 2: 스트리밍 응답

### T2.1: 기본 스트리밍 동작

**절차**:
1. `/chatbot` 페이지 접속
2. 질문 입력: "t-test는 언제 사용하나요?"
3. "전송" 버튼 클릭
4. 응답 관찰

**예상 결과**:
- ✅ 응답이 단어/문장 단위로 실시간 표시
- ✅ "생각 중..." 로딩 표시 없음 (즉시 시작)
- ✅ 마지막에 "✓ 완료" 표시 (선택)

**개발자 도구 확인**:
```
Network 탭 → /api/rag/stream 요청
→ Response 탭에서 스트리밍 데이터 확인:
  {"type":"metadata",...}
  {"chunk":"토큰"}
  {"chunk":"토큰"}
  ...
  {"done":true}
```

---

### T2.2: 스트리밍 응답 속도

**절차**:
1. 간단한 질문 입력: "ANOVA는?"
2. 응답 시간 측정
3. 5문장 이상 응답 받기

**예상 결과**:
- ✅ 응답 시작: 1-2초 이내
- ✅ 평균 속도: 100ms당 3-5단어
- ✅ 지연 없음: 버벅거리지 않음

---

### T2.3: 스트리밍 중단 & 복구

**절차**:
1. 질문 입력
2. 응답 중 네트워크 개발자 도구에서 연결 끊기
   ```
   DevTools → Network conditions → Offline
   ```
3. 응답 상태 확인

**예상 결과**:
- ✅ 부분 응답이 저장됨
- ✅ 에러 메시지 표시 (선택)
- ✅ 다시 질문 가능

---

### T2.4: <think> 태그 제거

**절차**:
1. 다양한 질문으로 여러 응답 받기
2. 응답 텍스트 확인

**예상 결과**:
- ✅ `<think>...</think>` 없음
- ✅ `&lt;think&gt;` HTML 이스케이프 없음
- ✅ 깔끔한 응답만 표시

---

## 🎯 Test Suite 3: 폴백 메커니즘

### T3.1: 스트리밍 실패 시 폴백

**절차**:
1. `/chatbot` 페이지 접속
2. 브라우저 콘솔에서 스트리밍 비활성화:
   ```javascript
   localStorage.setItem('enableStreaming', 'false')
   ```
3. 페이지 새로고침
4. 질문 입력

**예상 결과**:
- ✅ 스트리밍 사용하지 않음
- ✅ "생각 중..." 메시지 표시 후 응답
- ✅ 기존 방식과 동일하게 작동

---

### T3.2: API 라우트 에러

**절차**:
1. 네트워크 개발자 도구: Offline 설정
2. 질문 입력
3. 응답 대기

**예상 결과**:
- ✅ "오류가 발생했습니다" 메시지
- ✅ 콘솔에 에러 로그
- ✅ 세션은 유지됨

---

## 🎯 Test Suite 4: 메시지 저장

### T4.1: 스트리밍 응답 저장

**절차**:
1. 질문 입력 및 응답 수신
2. 페이지 새로고침
3. 같은 세션의 메시지 목록 확인

**예상 결과**:
- ✅ 질문과 응답이 모두 저장됨
- ✅ 참조 문서 정보 포함
- ✅ 타임스탐프 기록

**저장소 확인**:
```javascript
// 콘솔에서
const session = JSON.parse(localStorage.getItem('chatbot-session-*'))
console.log(session.messages)  // 모든 메시지 표시
```

---

### T4.2: 참조 문서 표시

**절차**:
1. 응답 하단의 "참조 문서 (n개)" 클릭
2. 문서 목록 확장

**예상 결과**:
- ✅ 문서 제목 표시
- ✅ 문서 내용 요약 (처음 100글자)
- ✅ 관련도 점수 표시 (0-100%)

---

## 🎯 Test Suite 5: UI 상호작용

### T5.1: 입력창 동작

**절차**:
1. 입력창에 텍스트 입력
2. Shift+Enter로 줄바꿈
3. Enter로 전송

**예상 결과**:
- ✅ Shift+Enter: 입력창에서 개행
- ✅ Enter: 메시지 전송
- ✅ 전송 후 입력창 초기화

---

### T5.2: 메시지 복사

**절차**:
1. AI 응답 메시지에 마우스 오버
2. "복사" 아이콘 클릭
3. 텍스트 에디터에 붙여넣기

**예상 결과**:
- ✅ 복사 아이콘 표시
- ✅ 클립보드에 복사됨
- ✅ "✓" 아이콘으로 변경 (2초)

---

### T5.3: 세션 관리

**절차**:
1. 좌측 사이드바에서 "새 대화" 클릭
2. 새 세션 생성 확인
3. 이전 세션 클릭하여 복구

**예상 결과**:
- ✅ 각 세션이 독립적
- ✅ 메시지 기록 유지
- ✅ 세션 전환 부드러움

---

## 🎯 Test Suite 6: 성능

### T6.1: 메모리 사용량

**절차**:
1. Chrome DevTools → Memory 탭
2. 스냅샷 1 촬영
3. 10개 질문 입력 & 응답 수신
4. 스냅샷 2 촬영
5. 메모리 증가량 비교

**예상 결과**:
- ✅ 메모리 증가: 10-50MB 이내
- ✅ 가비지 컬렉션 정상 작동
- ✅ 메모리 누수 없음

---

### T6.2: 응답 시간

**절차**:
1. DevTools → Network 탭 열기
2. 질문 입력
3. 응답 시간 측정

**성능 목표**:
```
검색 (RAG):        50-200ms
LLM 생성:          1-3초
전체 응답:         1.5-3.5초
스트리밍 지연:     100ms 이하
```

---

### T6.3: CPU 사용률

**절차**:
1. DevTools → Performance 탭
2. 녹화 시작
3. 질문 입력 & 응답 수신
4. 녹화 중지
5. 프로파일 분석

**예상 결과**:
- ✅ 메인 스레드 블로킹: 없음
- ✅ 프레임 드롭: 없음
- ✅ 스무스한 UI 애니메이션

---

## 🎯 Test Suite 7: 브라우저 호환성

### T7.1: 크로스 브라우저 테스트

| 브라우저 | 버전 | 크기조절 | 스트리밍 | 메시지 |
|---------|------|--------|---------|--------|
| Chrome | 120+ | ✅ | ✅ | ✅ |
| Firefox | 121+ | ✅ | ✅ | ✅ |
| Edge | 120+ | ✅ | ✅ | ✅ |
| Safari | 17+ | ✅ | ⚠️ | ✅ |

**Safari 주의사항**:
- `resize: both` 지원 확인
- `ReadableStream` 지원 확인

---

### T7.2: 모바일 테스트

**절차**:
1. DevTools → Device emulation
2. iPhone 14 / Android 선택
3. 각 기능 테스트

**예상 결과**:
- ✅ 팝업: 전체 화면 모드 (`max-md:`)
- ✅ 입력: 소프트 키보드 자동 표시
- ✅ 스트리밍: 정상 작동

---

## 📊 테스트 결과 보고서 템플릿

```markdown
# 테스트 결과 보고서

**테스트 날짜**: 2025-11-02
**테스트자**: [이름]
**환경**: Chrome 120, Windows 11

## 테스트 결과

### 크기 조절
- [ ] T1.1 기본 열기/닫기: ✅ PASS
- [ ] T1.2 4방향 조절: ✅ PASS
- [ ] T1.3 크기 제약: ✅ PASS
- [ ] T1.4 최소화: ✅ PASS

### 스트리밍
- [ ] T2.1 기본 동작: ✅ PASS
- [ ] T2.2 응답 속도: ✅ PASS
- [ ] T2.3 중단 & 복구: ✅ PASS
- [ ] T2.4 <think> 제거: ✅ PASS

### 폴백
- [ ] T3.1 스트리밍 실패: ✅ PASS
- [ ] T3.2 API 에러: ✅ PASS

### 기타
- [ ] T4 메시지 저장: ✅ PASS
- [ ] T5 UI 상호작용: ✅ PASS
- [ ] T6 성능: ✅ PASS
- [ ] T7 호환성: ✅ PASS

## 이슈 요약

없음

## 서명

테스트자: _________________ 날짜: _______
```

---

## 🐛 이슈 보고 방법

### 이슈 발견 시

1. **재현 방법** 상세 기록
2. **스크린샷/비디오** 첨부
3. **콘솔 에러** 캡처
4. **환경 정보** 포함

**템플릿**:
```markdown
## 이슈: [제목]

**심각도**: Critical / High / Medium / Low

**재현 방법**:
1. ...
2. ...
3. ...

**예상 결과**:
...

**실제 결과**:
...

**환경**:
- 브라우저: Chrome 120
- OS: Windows 11
- 스크린샷: [첨부]
```

---

## ✅ 테스트 완료 체크리스트

- [ ] 모든 Test Suite 완료
- [ ] 이슈 없음 또는 모두 기록됨
- [ ] 성능 목표 달성
- [ ] 크로스 브라우저 테스트 통과
- [ ] 테스트 결과 보고서 작성
- [ ] 승인자 서명

---

**작성**: Claude (AI Code Reviewer)
**최종 수정**: 2025-11-02
